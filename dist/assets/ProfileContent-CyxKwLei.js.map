{"version":3,"file":"ProfileContent-CyxKwLei.js","sources":["../../src/components/profiles/useProfileHandler.js","../../src/components/profiles/ProfileContent.jsx"],"sourcesContent":["// src/hooks/useProfileHandler.js\r\nimport { useState, useEffect } from \"react\";\r\nimport { useAuth } from \"../../context/AuthContext\";\r\nimport { getUserProfile, changeUserPassword } from \"../../services/profileServices\";\r\n\r\nexport default function useProfileHandler() {\r\n  const { user, updateUserProfile } = useAuth();\r\n\r\n  const [profile, setProfile] = useState({\r\n    first_name: \"\",\r\n    last_name: \"\",\r\n    email: \"\",\r\n    phone_number: \"\",\r\n    role: \"\",\r\n  });\r\n\r\n  const [passwords, setPasswords] = useState({\r\n    current_password: \"\",\r\n    new_password: \"\",\r\n    confirm_password: \"\",\r\n  });\r\n\r\n  const [profileLoading, setProfileLoading] = useState(false);\r\n  const [passwordLoading, setPasswordLoading] = useState(false);\r\n  const [message, setMessage] = useState(null);\r\n\r\n  /** Fetch profile on mount */\r\n  const fetchProfile = async () => {\r\n    try {\r\n      const res = await getUserProfile();\r\n      if (res?.status === \"success\" && res?.data) {\r\n        const updatedProfile = {\r\n          first_name: res.data.first_name || \"\",\r\n          last_name: res.data.last_name || \"\",\r\n          email: res.data.email || \"\",\r\n          phone_number: res.data.phone_number || \"\",\r\n          role: res.data.role || \"\",\r\n        };\r\n        setProfile(updatedProfile);\r\n        updateUserProfile(updatedProfile); // update global context\r\n      }\r\n    } catch (error) {\r\n      console.error(error);\r\n      setMessage({ type: \"error\", text: \"Failed to load profile. Please try again.\" });\r\n    }\r\n  };\r\n\r\n  /** Handle input changes */\r\n  const handleProfileChange = (e) => {\r\n    const { name, value } = e.target;\r\n    setProfile((prev) => ({ ...prev, [name]: value }));\r\n  };\r\n\r\n  const handlePasswordChange = (e) => {\r\n    const { name, value } = e.target;\r\n    setPasswords((prev) => ({ ...prev, [name]: value }));\r\n  };\r\n\r\n  /** Submit updated profile */\r\n  const handleProfileSubmit = async (e) => {\r\n    e.preventDefault();\r\n    setProfileLoading(true);\r\n\r\n    try {\r\n      const updated = await updateUserProfile(profile);\r\n      setProfile(updated); // update local state\r\n      setMessage({ type: \"success\", text: \"Profile updated successfully!\" });\r\n    } catch (error) {\r\n      setMessage({\r\n        type: \"error\",\r\n        text: error.response?.data?.message || \"Error updating profile. Please try again.\",\r\n      });\r\n    } finally {\r\n      setProfileLoading(false);\r\n    }\r\n  };\r\n\r\n  /** Submit password change (admin only) */\r\n  const handlePasswordSubmit = async (e) => {\r\n    e.preventDefault();\r\n    setPasswordLoading(true);\r\n\r\n    if (profile.role !== \"admin\") {\r\n      setMessage({ type: \"error\", text: \"Only administrators are allowed to change passwords.\" });\r\n      setPasswordLoading(false);\r\n      return;\r\n    }\r\n\r\n    if (passwords.new_password !== passwords.confirm_password) {\r\n      setMessage({ type: \"error\", text: \"New password and confirmation do not match.\" });\r\n      setPasswordLoading(false);\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const res = await changeUserPassword({\r\n        current_password: passwords.current_password,\r\n        new_password: passwords.new_password,\r\n        confirm_password: passwords.confirm_password,\r\n      });\r\n\r\n      if (res?.status === \"success\") {\r\n        setMessage({ type: \"success\", text: res.message || \"Password changed successfully!\" });\r\n        setPasswords({ current_password: \"\", new_password: \"\", confirm_password: \"\" });\r\n      } else {\r\n        throw new Error(\"Password change failed\");\r\n      }\r\n    } catch (error) {\r\n      setMessage({\r\n        type: \"error\",\r\n        text: error.response?.data?.message || \"Error changing password. Please try again.\",\r\n      });\r\n    } finally {\r\n      setPasswordLoading(false);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchProfile();\r\n  }, []);\r\n\r\n  return {\r\n    profile,\r\n    passwords,\r\n    profileLoading,\r\n    passwordLoading,\r\n    message,\r\n    setMessage,\r\n    handleProfileChange,\r\n    handlePasswordChange,\r\n    handleProfileSubmit,\r\n    handlePasswordSubmit,\r\n  };\r\n}\r\n","// src/components/ProfileContent.jsx\r\nimport React from \"react\";\r\nimport useProfileHandler from \"./useProfileHandler\"; // ✅ updated path\r\nimport MessageToast from \"../MessageToast\"; // ✅ updated path\r\n\r\nexport default function ProfileContent() {\r\n  const {\r\n    profile,\r\n    passwords,\r\n    profileLoading,\r\n    passwordLoading,\r\n    message,\r\n    setMessage,\r\n    handleProfileChange,\r\n    handlePasswordChange,\r\n    handleProfileSubmit,\r\n    handlePasswordSubmit,\r\n  } = useProfileHandler();\r\n\r\n  return (\r\n    <>\r\n      <MessageToast message={message} onClose={() => setMessage(null)} />\r\n\r\n      <main className=\"w-full min-h-[calc(100vh-64px)] p-4 bg-gray-50 overflow-y-auto\">\r\n        <div className=\"mx-auto space-y-8\">\r\n          {/* Profile Section */}\r\n          <section className=\"bg-white rounded-2xl border border-gray-200 px-8 py-4 shadow-sm\">\r\n            <div className=\"mb-6\">\r\n              <h2 className=\"text-xl font-semibold text-gray-900\">\r\n                Profile Information\r\n              </h2>\r\n              <p className=\"text-sm text-gray-500 mt-1\">\r\n                Update your account’s profile information.\r\n              </p>\r\n            </div>\r\n\r\n            <form onSubmit={handleProfileSubmit} className=\"space-y-5\">\r\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-5\">\r\n                <div className=\"flex flex-col\">\r\n                  <label className=\"text-sm font-medium text-gray-700\">First name</label>\r\n                  <input\r\n                    name=\"first_name\"\r\n                    value={profile.first_name}\r\n                    onChange={handleProfileChange}\r\n                    type=\"text\"\r\n                    placeholder=\"John\"\r\n                    required\r\n                    className=\"mt-1 w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-fuchsia-500\"\r\n                  />\r\n                </div>\r\n\r\n                <div className=\"flex flex-col\">\r\n                  <label className=\"text-sm font-medium text-gray-700\">Last name</label>\r\n                  <input\r\n                    name=\"last_name\"\r\n                    value={profile.last_name}\r\n                    onChange={handleProfileChange}\r\n                    type=\"text\"\r\n                    placeholder=\"Doe\"\r\n                    required\r\n                    className=\"mt-1 w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-fuchsia-500\"\r\n                  />\r\n                </div>\r\n              </div>\r\n\r\n              <div className=\"flex flex-col\">\r\n                <label className=\"text-sm font-medium text-gray-700\">Phone number</label>\r\n                <input\r\n                  name=\"phone_number\"\r\n                  value={profile.phone_number}\r\n                  onChange={handleProfileChange}\r\n                  type=\"tel\"\r\n                  placeholder=\"09453748272\"\r\n                  className=\"mt-1 w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:ring-2 focus:ring-fuchsia-500\"\r\n                />\r\n              </div>\r\n\r\n              <div className=\"flex flex-col\">\r\n                <label className=\"text-sm font-medium text-gray-700\">Email</label>\r\n                <input\r\n                  name=\"email\"\r\n                  value={profile.email}\r\n                  onChange={handleProfileChange}\r\n                  type=\"email\"\r\n                  placeholder=\"johndoe@gmail.com\"\r\n                  required\r\n                  className=\"mt-1 w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:ring-2 focus:ring-fuchsia-500\"\r\n                />\r\n              </div>\r\n\r\n              <div className=\"pt-4 flex justify-start\">\r\n                <button\r\n                  type=\"submit\"\r\n                  disabled={profileLoading}\r\n                  className=\"inline-flex justify-center rounded-md bg-fuchsia-700 px-6 py-2 text-sm font-medium text-white hover:bg-fuchsia-800 focus:ring-2 focus:ring-fuchsia-400 disabled:opacity-50\"\r\n                >\r\n                  {profileLoading ? \"Saving...\" : \"Save\"}\r\n                </button>\r\n              </div>\r\n            </form>\r\n          </section>\r\n\r\n          {/* Password Section (Admin Only) */}\r\n          {profile.role === \"admin\" && (\r\n            <section className=\"bg-white rounded-2xl border border-gray-200 px-8 py-4 shadow-sm\">\r\n              <div className=\"mb-6\">\r\n                <h2 className=\"text-xl font-semibold text-gray-900\">Password</h2>\r\n                <p className=\"text-sm text-gray-500 mt-1\">\r\n                  Ensure your account is using a long, random password.\r\n                </p>\r\n              </div>\r\n\r\n              <form onSubmit={handlePasswordSubmit} className=\"space-y-5\">\r\n                <input\r\n                  type=\"password\"\r\n                  name=\"current_password\"\r\n                  value={passwords.current_password}\r\n                  onChange={handlePasswordChange}\r\n                  placeholder=\"Current password\"\r\n                  className=\"w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:ring-2 focus:ring-fuchsia-500\"\r\n                />\r\n                <input\r\n                  type=\"password\"\r\n                  name=\"new_password\"\r\n                  value={passwords.new_password}\r\n                  onChange={handlePasswordChange}\r\n                  placeholder=\"New password\"\r\n                  className=\"w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:ring-2 focus:ring-fuchsia-500\"\r\n                />\r\n                <input\r\n                  type=\"password\"\r\n                  name=\"confirm_password\"\r\n                  value={passwords.confirm_password}\r\n                  onChange={handlePasswordChange}\r\n                  placeholder=\"Confirm password\"\r\n                  className=\"w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:ring-2 focus:ring-fuchsia-500\"\r\n                />\r\n\r\n                <div className=\"pt-4 flex justify-start\">\r\n                  <button\r\n                    type=\"submit\"\r\n                    disabled={passwordLoading}\r\n                    className=\"inline-flex justify-center rounded-md bg-fuchsia-700 px-6 py-2 text-sm font-medium text-white hover:bg-fuchsia-800 focus:ring-2 focus:ring-fuchsia-400 disabled:opacity-50\"\r\n                  >\r\n                    {passwordLoading ? \"Saving...\" : \"Save\"}\r\n                  </button>\r\n                </div>\r\n              </form>\r\n            </section>\r\n          )}\r\n        </div>\r\n      </main>\r\n\r\n      <footer className=\"bg-gray-200 py-4 w-full\">\r\n        <div className=\"text-center text-sm text-gray-700\">\r\n          &copy; 2025 DSC Souvenirs. All rights reserved.\r\n        </div>\r\n      </footer>\r\n    </>\r\n  );\r\n}\r\n"],"names":["useProfileHandler","user","updateUserProfile","useAuth","profile","setProfile","useState","passwords","setPasswords","profileLoading","setProfileLoading","passwordLoading","setPasswordLoading","message","setMessage","fetchProfile","res","getUserProfile","updatedProfile","error","handleProfileChange","e","name","value","prev","handlePasswordChange","handleProfileSubmit","updated","handlePasswordSubmit","changeUserPassword","useEffect","ProfileContent","jsxs","Fragment","jsx","MessageToast"],"mappings":"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"}