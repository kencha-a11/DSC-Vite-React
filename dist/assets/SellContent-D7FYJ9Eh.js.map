{"version":3,"file":"SellContent-D7FYJ9Eh.js","sources":["../../src/services/saleServices.js","../../src/components/sells/useSellHandler.js","../../src/utils/normalizedCategory.js","../../src/components/sells/ProductRow.jsx","../../src/components/sells/CartItem.jsx","../../src/components/sells/ConfirmModal.jsx","../../src/components/sells/ClearCartDialogue.jsx","../../src/components/sells/LeaveCartItemDialog.jsx","../../src/components/sells/SellContent.jsx"],"sourcesContent":["// src/api/sales.js\r\nimport { api } from \"../api/axios\";\r\n\r\nexport async function createTransaction(payload) {\r\n  try {\r\n    const now = new Date();\r\n    const timezone = Intl.DateTimeFormat().resolvedOptions().timeZone;\r\n\r\n    const payloadWithTimestamp = {\r\n      ...payload,\r\n      device_datetime: now.toISOString(), // precise device timestamp\r\n      device_timezone: timezone,          // e.g., \"Asia/Manila\"\r\n    };\r\n\r\n    const res = await api.post(\"/sales/store\", payloadWithTimestamp);\r\n    return res.data;\r\n  } catch (error) {\r\n    console.error(\"Transaction failed:\", error);\r\n    console.error(\"Response:\", error.response?.data);\r\n    throw error;\r\n  }\r\n}\r\n","import { useState, useMemo, useRef, useEffect, useCallback } from \"react\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport { getSellProductsData } from \"../../services/productServices\";\r\nimport { createTransaction } from \"../../services/saleServices\";\r\nimport useDebounce from \"../../hooks/useDebounce\";\r\nimport useInfiniteScroll from \"../../hooks/useInfiniteScroll\";\r\n\r\nexport default function useSellHandler() {\r\n  const navigate = useNavigate();\r\n\r\n  const [products, setProducts] = useState([]);\r\n  const [cartItems, setCartItems] = useState([]);\r\n  const [selectedCategory, setSelectedCategory] = useState(\"All\");\r\n  const [searchInput, setSearchInput] = useState(\"\");\r\n  const [page, setPage] = useState(1);\r\n  const [hasMore, setHasMore] = useState(true);\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [message, setMessage] = useState(null);\r\n  const [showConfirm, setShowConfirm] = useState(false);\r\n  const [isProcessing, setIsProcessing] = useState(false);\r\n  const [showClearCartConfirm, setShowClearCartConfirm] = useState(false);\r\n  const [showLeaveCartDialog, setShowLeaveCartDialog] = useState(false);\r\n  const [pendingNavigation, setPendingNavigation] = useState(null);\r\n\r\n  const loaderRef = useRef();\r\n  const debouncedSearch = useDebounce(searchInput, 400);\r\n\r\n  // --- Fetch products from backend ---\r\n  const fetchProducts = useCallback(\r\n    async (pageToFetch = 1) => {\r\n      setIsLoading(true);\r\n      try {\r\n        const res = await getSellProductsData(pageToFetch, 10, debouncedSearch, selectedCategory);\r\n        const { data, hasMore } = res;\r\n        setProducts((prev) => (pageToFetch === 1 ? data : [...prev, ...data]));\r\n        setHasMore(hasMore);\r\n      } catch {\r\n        setMessage({ type: \"error\", text: \"Failed to load products\" });\r\n      } finally {\r\n        setIsLoading(false);\r\n      }\r\n    },\r\n    [debouncedSearch, selectedCategory]\r\n  );\r\n\r\n  useEffect(() => {\r\n    fetchProducts(page);\r\n  }, [page, fetchProducts]);\r\n\r\n  useEffect(() => {\r\n    setProducts([]);\r\n    setPage(1);\r\n    setHasMore(true);\r\n  }, [debouncedSearch, selectedCategory]);\r\n\r\n  // --- Build category list dynamically from products ---\r\n  const categories = useMemo(() => {\r\n    const categorySet = new Set();\r\n\r\n    products.forEach((product) => {\r\n      if (Array.isArray(product.categories) && product.categories.length > 0) {\r\n        product.categories.forEach((cat) => {\r\n          if (cat?.name) categorySet.add(cat.name);\r\n        });\r\n      } else {\r\n        categorySet.add(\"Uncategorized\");\r\n      }\r\n    });\r\n\r\n    const uniqueCategories = Array.from(categorySet).map((name, idx) => ({\r\n      id: idx + 1,\r\n      category_name: name,\r\n    }));\r\n\r\n    // Always include \"All\" at the beginning\r\n    return [{ id: 0, category_name: \"All\" }, ...uniqueCategories];\r\n  }, [products]);\r\n\r\n  // --- Infinite scroll ---\r\n  useInfiniteScroll(\r\n    loaderRef,\r\n    () => {\r\n      if (hasMore && !isLoading) setPage((prev) => prev + 1);\r\n    },\r\n    hasMore,\r\n    isLoading\r\n  );\r\n\r\n  // --- Cart helpers ---\r\n  const productsMap = useMemo(() => {\r\n    const map = new Map();\r\n    products.forEach((p) => map.set(p.id, p.stock_quantity ?? 0));\r\n    return map;\r\n  }, [products]);\r\n\r\n  const getStockFor = useCallback((id) => productsMap.get(id) ?? 0, [productsMap]);\r\n\r\n  const handleAddToCart = useCallback(\r\n    (product) => {\r\n      setCartItems((prev) => {\r\n        const existing = prev.find((it) => it.id === product.id);\r\n        const stock = getStockFor(product.id);\r\n        if (existing) {\r\n          if (existing.quantity + 1 > stock) {\r\n            setMessage({ type: \"info\", text: \"Stock limit reached\" });\r\n            return prev;\r\n          }\r\n          return prev.map((it) =>\r\n            it.id === product.id ? { ...it, quantity: it.quantity + 1 } : it\r\n          );\r\n        }\r\n        if (stock === 0) {\r\n          setMessage({ type: \"info\", text: \"Item out of stock\" });\r\n          return prev;\r\n        }\r\n        return [...prev, { id: product.id, quantity: 1, product }];\r\n      });\r\n    },\r\n    [getStockFor]\r\n  );\r\n\r\n  const updateCartItem = useCallback(\r\n    (id, quantity) => {\r\n      const stock = getStockFor(id);\r\n      if (quantity > stock) {\r\n        quantity = stock;\r\n        setMessage({ type: \"info\", text: \"Stock limit reached\" });\r\n      }\r\n      setCartItems((prev) =>\r\n        quantity <= 0\r\n          ? prev.filter((it) => it.id !== id)\r\n          : prev.map((it) => (it.id === id ? { ...it, quantity } : it))\r\n      );\r\n    },\r\n    [getStockFor]\r\n  );\r\n\r\n  const total = useMemo(\r\n    () =>\r\n      cartItems.reduce(\r\n        (sum, it) => sum + Number(it.product?.price ?? 0) * it.quantity,\r\n        0\r\n      ),\r\n    [cartItems]\r\n  );\r\n\r\n  // --- Transaction handling ---\r\n  const handleCompletePurchase = useCallback(() => {\r\n    if (!cartItems.length)\r\n      return setMessage({ type: \"info\", text: \"Cart is empty\" });\r\n    setShowConfirm(true);\r\n  }, [cartItems]);\r\n\r\n  const confirmTransaction = useCallback(async () => {\r\n    const snapshot = [...cartItems];\r\n    if (!snapshot.length) {\r\n      setMessage({ type: \"info\", text: \"Cart is empty\" });\r\n      setShowConfirm(false);\r\n      return;\r\n    }\r\n\r\n    setShowConfirm(false);\r\n    setIsProcessing(true);\r\n\r\n    const totalAmount = snapshot.reduce(\r\n      (sum, it) => sum + Number(it.product.price ?? 0) * it.quantity,\r\n      0\r\n    );\r\n    const payload = {\r\n      items: snapshot.map((it) => ({\r\n        product_id: it.id,\r\n        quantity: it.quantity,\r\n        snapshot_name: it.product.name,\r\n        snapshot_price: it.product.price,\r\n      })),\r\n      total_amount: totalAmount,\r\n    };\r\n\r\n    try {\r\n      const res = await createTransaction(payload);\r\n      if (res?.sale_id || res?.sale) {\r\n        setProducts((prev) =>\r\n          prev.map((p) => {\r\n            const purchased = snapshot.find((it) => it.id === p.id);\r\n            return purchased\r\n              ? {\r\n                  ...p,\r\n                  stock_quantity: Math.max(\r\n                    (p.stock_quantity ?? 0) - purchased.quantity,\r\n                    0\r\n                  ),\r\n                }\r\n              : p;\r\n          })\r\n        );\r\n        setCartItems([]);\r\n        setMessage({\r\n          type: \"success\",\r\n          text: res?.message || \"Transaction successful!\",\r\n        });\r\n        setPage(1);\r\n        setHasMore(true);\r\n      } else {\r\n        setMessage({ type: \"error\", text: res?.message || \"Transaction failed\" });\r\n      }\r\n    } catch (err) {\r\n      const errorMsg =\r\n        err.response?.data?.message ||\r\n        err.message ||\r\n        \"Transaction failed. Try again.\";\r\n      setMessage({ type: \"error\", text: errorMsg });\r\n    } finally {\r\n      setIsProcessing(false);\r\n    }\r\n  }, [cartItems]);\r\n\r\n  // --- Warn before leaving with items in cart ---\r\n  useEffect(() => {\r\n    const handler = (e) => {\r\n      if (cartItems.length > 0) {\r\n        e.preventDefault();\r\n        e.returnValue = \"\";\r\n      }\r\n    };\r\n    window.addEventListener(\"beforeunload\", handler);\r\n    return () => window.removeEventListener(\"beforeunload\", handler);\r\n  }, [cartItems]);\r\n\r\n  return {\r\n    products,\r\n    cartItems,\r\n    categories,\r\n    selectedCategory,\r\n    searchInput,\r\n    loaderRef,\r\n    message,\r\n    showConfirm,\r\n    showClearCartConfirm,\r\n    showLeaveCartDialog,\r\n    isProcessing,\r\n    total,\r\n    isLoading,\r\n    setSearchInput,\r\n    setSelectedCategory,\r\n    handleAddToCart,\r\n    updateCartItem,\r\n    handleCompletePurchase,\r\n    confirmTransaction,\r\n    setCartItems,\r\n    setShowConfirm,\r\n    setShowClearCartConfirm,\r\n    setShowLeaveCartDialog,\r\n    setMessage,\r\n    navigate,\r\n    pendingNavigation,\r\n    setPendingNavigation,\r\n    getStockFor,\r\n  };\r\n}\r\n","export function normalizeCategory(product) {\r\n  if (!product.categories || !product.categories.length) return \"No Category\";\r\n  return product.categories.map(c => c.name).join(\", \");\r\n}\r\n","import React from \"react\";\r\nimport { normalizeCategory } from \"../../utils/normalizedCategory\";\r\nimport { formatPeso } from \"../../utils/formatPeso\";\r\n\r\nconst ProductRow = ({ product, onAdd, style }) => {\r\n  const stock = product?.stock_quantity ?? product?.stock ?? 0;\r\n  const lowStockThreshold = product?.low_stock_threshold ?? 5;\r\n\r\n  const handleClick = () => {\r\n    if (stock > 0) onAdd(product); // pass full product instead of just ID\r\n  };\r\n\r\n  const img =\r\n    product?.images_path?.length > 0\r\n      ? product.images_path.find((img) => img.is_primary)?.image_path ||\r\n      product.images_path[0].image_path\r\n      : product?.image || null;\r\n\r\n  return (\r\n    <div\r\n      style={style}\r\n      onClick={handleClick}\r\n      className={`relative flex items-start justify-between p-4 border border-gray-200 rounded-lg cursor-pointer hover:bg-gray-50 transition duration-150 ease-in-out ${stock <= 0 ? \"opacity-50 pointer-events-none\" : \"\"\r\n        }`}\r\n    >\r\n      {/* Left section: Image + Info */}\r\n      <div className=\"flex items-start gap-4\">\r\n        {/* Product Image */}\r\n        <div className=\"shrink-0 w-34 h-34 rounded border border-gray-200 flex items-center justify-center bg-gray-100 overflow-hidden\">\r\n          {img ? (\r\n            <img\r\n              src={img}\r\n              alt={product.name || \"Product\"}\r\n              className=\"w-full h-full object-cover\"\r\n              onError={(e) => (e.target.style.display = \"none\")}\r\n            />\r\n          ) : (\r\n            <span className=\"text-gray-400 text-sm\">No Image</span>\r\n          )}\r\n        </div>\r\n\r\n        {/* Product Info */}\r\n        <div className=\"flex flex-col justify-between h-34 py-1\">\r\n          <div>\r\n            <h3 className=\"font-semibold text-lg text-gray-800 leading-tight\">\r\n              {product.name || \"Unnamed Product\"}\r\n            </h3>\r\n            <p className=\"text-base text-gray-500\">\r\n              {normalizeCategory(product) || \"No Category\"}\r\n            </p>\r\n          </div>\r\n          <p\r\n            className={`text-base ${stock <= lowStockThreshold ? \"text-red-500\" : \"text-gray-500\"\r\n              }`}\r\n          >\r\n            Stocks : {stock}\r\n          </p>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Unit Price in upper-right corner */}\r\n      <div className=\"absolute top-4 right-5 text-base font-semibold text-gray-800 whitespace-nowrap\">\r\n        Unit price : {formatPeso(product.price)}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default React.memo(ProductRow);\r\n","import React, { useState, useEffect, useCallback } from \"react\";\r\nimport { normalizeCategory } from \"../../utils/normalizedCategory\";\r\nimport { formatPeso } from \"../../utils/formatPeso\";\r\n\r\nfunction CartItem({ item, product, stock, onUpdateQuantity, onLimit }) {\r\n  const name = product?.name ?? \"Unavailable\";\r\n  const price = Number(product?.price ?? 0);\r\n  const subtotal = price * item.quantity;\r\n\r\n  // Use a more reliable placeholder\r\n  const defaultImg = `/fallback.png`; // optional local fallback\r\n  const placeholderImg = `https://via.placeholder.com/64x64.png?text=${encodeURIComponent(\r\n    name.charAt(0) || \"P\"\r\n  )}`;\r\n  const img = product?.image || placeholderImg;\r\n\r\n  const [inputQty, setInputQty] = useState(item.quantity);\r\n\r\n  // Sync internal input state with actual quantity\r\n  useEffect(() => {\r\n    setInputQty(item.quantity);\r\n  }, [item.quantity]);\r\n\r\n  const handleChange = useCallback(\r\n    (e) => {\r\n      const val = e.target.value.replace(/\\D/g, \"\");\r\n      const newVal = val === \"\" ? \"\" : Math.min(Number(val), stock);\r\n      setInputQty(newVal);\r\n    },\r\n    [stock]\r\n  );\r\n\r\n  const handleBlur = useCallback(() => {\r\n    const qty = Number(inputQty || 0);\r\n    onUpdateQuantity(item.id, qty);\r\n  }, [inputQty, item.id, onUpdateQuantity]);\r\n\r\n  const increment = useCallback(() => {\r\n    if (item.quantity < stock) onUpdateQuantity(item.id, item.quantity + 1);\r\n    else onLimit();\r\n  }, [item.id, item.quantity, stock, onUpdateQuantity, onLimit]);\r\n\r\n  const decrement = useCallback(() => {\r\n    onUpdateQuantity(item.id, Math.max(item.quantity - 1, 0));\r\n  }, [item.id, item.quantity, onUpdateQuantity]);\r\n\r\n  return (\r\n    <div className=\"border border-gray-300 rounded-lg p-3 bg-white\">\r\n      <div className=\"flex items-start gap-3\">\r\n        <div className=\"w-16 h-16 border border-gray-200 rounded flex items-center justify-center bg-gray-50 overflow-hidden\">\r\n          <img\r\n            src={img}\r\n            alt={name}\r\n            className=\"object-cover w-full h-full rounded\"\r\n            onError={(e) => {\r\n              e.onerror = null;\r\n              e.target.src = defaultImg;\r\n            }}\r\n          />\r\n        </div>\r\n        <div className=\"flex flex-col flex-1\">\r\n          <div className=\"text-sm font-semibold text-gray-800\">{name}</div>\r\n          <div className=\"text-xs text-gray-500\">{normalizeCategory(product)}</div>\r\n          <div className=\"text-xs text-gray-500\">Stocks: {stock}</div>\r\n          <div className=\"text-xs text-gray-600\">Unit Price: {formatPeso(price)}</div>\r\n          <div className=\"text-xs text-gray-600 font-medium\">\r\n            Subtotal: {formatPeso(subtotal)}\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"mt-3 flex items-center justify-between\">\r\n        <span className=\"text-xs text-gray-600\">Quantity:</span>\r\n        <div className=\"flex items-center gap-1\">\r\n          <button\r\n            onClick={decrement}\r\n            type=\"button\"\r\n            className=\"w-6 h-6 border border-gray-300 rounded text-sm flex items-center justify-center hover:bg-gray-100 transition\"\r\n          >\r\n            âˆ’\r\n          </button>\r\n\r\n          <input\r\n            type=\"text\"\r\n            value={inputQty}\r\n            onChange={handleChange}\r\n            onBlur={handleBlur}\r\n            className=\"w-8 text-center border border-gray-300 rounded text-xs py-0.5\"\r\n          />\r\n\r\n          <button\r\n            onClick={increment}\r\n            type=\"button\"\r\n            className={`w-6 h-6 border border-gray-300 rounded text-sm flex items-center justify-center transition ${\r\n              item.quantity >= stock ? \"opacity-50 cursor-not-allowed\" : \"hover:bg-gray-100\"\r\n            }`}\r\n          >\r\n            +\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n// Only re-render if quantity, stock, or product reference changes\r\nexport default React.memo(\r\n  CartItem,\r\n  (prev, next) =>\r\n    prev.item.quantity === next.item.quantity &&\r\n    prev.stock === next.stock &&\r\n    prev.product === next.product\r\n);\r\n","import React, { useMemo } from \"react\";\r\nimport { formatPeso } from \"../../utils/formatPeso\";\r\n\r\nconst ConfirmModal = ({ cartItems = [], onConfirm, onClose, title = \"Confirm Purchase\" }) => {\r\n  console.log(\"Rendering ConfirmModal with cartItems:\", cartItems);\r\n\r\n  const total = useMemo(\r\n    () =>\r\n      cartItems.reduce(\r\n        (acc, item) => acc + (item.product?.price ?? 0) * item.quantity,\r\n        0\r\n      ),\r\n    [cartItems]\r\n  );\r\n\r\n  if (cartItems.length === 0) {\r\n    console.log(\"ConfirmModal: cartItems empty!\");\r\n    return null;\r\n  }\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 flex items-center justify-center bg-black/50 z-50 px-4\">\r\n      <div className=\"bg-white rounded-2xl shadow-xl w-full max-w-lg flex flex-col  border-2 border-pink-400\" style={{maxHeight: '90vh'}}>\r\n        {/* Header */}\r\n        <div className=\"px-6 py-5 border-b border-gray-200\">\r\n          <h3 className=\"text-xl font-semibold text-gray-900\">{title}</h3>\r\n        </div>\r\n\r\n        {/* Items List */}\r\n        <div className=\"flex-1 overflow-y-auto px-6 py-4\">\r\n          {cartItems.map((item) => (\r\n            <div\r\n              key={item.id}\r\n              className=\"flex justify-between items-center py-3 text-base text-gray-700\"\r\n            >\r\n              <span className=\"font-normal\">\r\n                {item.product?.name ?? \"Unavailable\"} <span className=\"mx-2\">x</span> {item.quantity}\r\n              </span>\r\n              <span className=\"font-medium\">{formatPeso((item.product?.price ?? 0) * item.quantity)}</span>\r\n            </div>\r\n          ))}\r\n        </div>\r\n\r\n        {/* Total Section */}\r\n        <div className=\"px-6 py-5 border-t border-gray-200\">\r\n          <div className=\"flex justify-between items-center mb-6\">\r\n            <span className=\"text-lg font-semibold text-gray-900\">Total:</span>\r\n            <span className=\"text-lg font-bold text-gray-900\">{formatPeso(total)}</span>\r\n          </div>\r\n\r\n          {/* Buttons */}\r\n          <div className=\"flex justify-end gap-3\">\r\n            <button\r\n              onClick={onClose}\r\n              className=\"px-6 py-2.5 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 transition font-medium\"\r\n            >\r\n              Cancel\r\n            </button>\r\n            <button\r\n              onClick={onConfirm}\r\n              className=\"px-6 py-2.5 bg-pink-500 text-white rounded-lg hover:bg-pink-600 transition font-medium\"\r\n            >\r\n              Confirm\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ConfirmModal;","import React from 'react';\r\n\r\nconst ClearCartDialogue = ({ onConfirm, onCancel, message, subMessage }) => {\r\n  return (\r\n    <div className=\"fixed inset-0 z-1000 flex items-center justify-center px-4\">\r\n      {/* Background overlay - visible but darkened */}\r\n      <div\r\n        className=\"fixed inset-0 bg-black/50\"\r\n        onClick={onCancel}\r\n      />\r\n\r\n      {/* Modal content */}\r\n      <div className=\"relative z-10 bg-white rounded-2xl shadow-2xl max-w-md w-full p-8 border-2 border-pink-500\">\r\n        {/* Message */}\r\n        <div className=\"text-center space-y-2\">\r\n          <h3 className=\"text-2xl font-bold text-gray-900 leading-tight\">\r\n            {message || \"Are you sure you want to remove all items from your cart?\"}\r\n          </h3>\r\n          <p className=\"text-gray-400 text-lg\">\r\n            {subMessage || \"This action cannot be undone.\"}\r\n          </p>\r\n        </div>\r\n\r\n        {/* Buttons */}\r\n        <div className=\"mt-8 flex gap-4\">\r\n          <button\r\n            onClick={onCancel}\r\n            className=\"flex-1 px-8 py-3.5 rounded-xl text-lg font-semibold text-gray-400 bg-gray-200 hover:bg-gray-300 focus:outline-none transition duration-150 ease-in-out\"\r\n          >\r\n            Cancel\r\n          </button>\r\n          <button\r\n            onClick={onConfirm}\r\n            className=\"flex-1 px-8 py-3.5 rounded-xl text-lg font-semibold text-white bg-pink-500 hover:bg-pink-600 focus:outline-none transition duration-150 ease-in-out\"\r\n          >\r\n            Yes\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ClearCartDialogue;","import React from 'react';\r\n\r\nconst LeaveCartItemDialog = ({ onConfirm, onCancel, message, subMessage }) => {\r\n  return (\r\n    <div className=\"fixed inset-0 z-1000 flex items-center justify-center px-4\">\r\n      {/* Background overlay - visible but darkened */}\r\n      <div\r\n        className=\"fixed inset-0 bg-black/50\"\r\n        onClick={onCancel}\r\n      />\r\n\r\n      {/* Modal content */}\r\n      <div className=\"relative z-10 bg-white rounded-2xl shadow-2xl max-w-md w-full p-8 border-2 border-pink-500\">\r\n        {/* Message */}\r\n        <div className=\"text-center space-y-2\">\r\n          <h3 className=\"text-2xl font-bold text-gray-900 leading-tight\">\r\n            {message}\r\n          </h3>\r\n          <p className=\"text-gray-400 text-lg\">\r\n            {subMessage}\r\n          </p>\r\n        </div>\r\n\r\n        {/* Buttons */}\r\n        <div className=\"mt-8 flex gap-4\">\r\n          <button\r\n            onClick={onCancel}\r\n            className=\"flex-1 px-8 py-3.5 rounded-xl text-lg font-semibold text-gray-400 bg-gray-200 hover:bg-gray-300 focus:outline-none transition duration-150 ease-in-out\"\r\n          >\r\n            Cancel\r\n          </button>\r\n          <button\r\n            onClick={onConfirm}\r\n            className=\"flex-1 px-8 py-3.5 rounded-xl text-lg font-semibold text-white bg-pink-500 hover:bg-pink-600 focus:outline-none transition duration-150 ease-in-out\"\r\n          >\r\n            Yes\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default LeaveCartItemDialog;","import React from \"react\";\r\nimport useSellHandler from \"./useSellHandler\";\r\nimport { formatPeso } from \"../../utils/formatPeso\";\r\nimport ProductRow from \"./ProductRow\";\r\nimport CartItem from \"./CartItem\";\r\nimport MessageToast from \"../MessageToast\";\r\nimport ConfirmModal from \"./ConfirmModal\";\r\nimport ClearCartDialogue from \"./ClearCartDialogue\";\r\nimport LeaveCartItemDialog from \"./LeaveCartItemDialog\";\r\n\r\nexport default function SellsContent() {\r\n  const {\r\n    products,\r\n    cartItems,\r\n    categories,\r\n    selectedCategory,\r\n    searchInput,\r\n    loaderRef,\r\n    message,\r\n    showConfirm,\r\n    showClearCartConfirm,\r\n    showLeaveCartDialog,\r\n    isProcessing,\r\n    total,\r\n    isLoading,\r\n    setSearchInput,\r\n    setSelectedCategory,\r\n    handleAddToCart,\r\n    updateCartItem,\r\n    handleCompletePurchase,\r\n    confirmTransaction,\r\n    setCartItems,\r\n    setShowConfirm,\r\n    setShowClearCartConfirm,\r\n    setShowLeaveCartDialog,\r\n    setMessage,\r\n    navigate,\r\n    pendingNavigation,\r\n    setPendingNavigation,\r\n    getStockFor,\r\n  } = useSellHandler();\r\n\r\n  // --- Render ---\r\n  return (\r\n    <div className=\"flex flex-col md:flex-row h-[91vh]\">\r\n      {/* Products List */}\r\n      <div className=\"flex-1 bg-white border border-gray-200 rounded-xl flex flex-col overflow-hidden mt-4 mx-4\">\r\n        <div className=\"p-4 border-b border-gray-200 flex gap-3\">\r\n          <input\r\n            type=\"text\"\r\n            placeholder=\"Search items\"\r\n            value={searchInput}\r\n            onChange={e => setSearchInput(e.target.value)}\r\n            className=\"flex-1 border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-1 focus:ring-pink-500\"\r\n          />\r\n          <select\r\n            value={selectedCategory}\r\n            onChange={e => setSelectedCategory(e.target.value)}\r\n            className=\"w-40 border border-gray-300 rounded-md px-3 py-2 text-sm focus:border-pink-500 focus:ring-1 focus:ring-pink-500 focus:outline-none transition-colors duration-200\"\r\n          >\r\n            {categories.map(c => <option key={c.id} value={c.category_name}>{c.category_name}</option>)}\r\n          </select>\r\n        </div>\r\n        <div className=\"flex-1 overflow-y-auto px-4 py-2\">\r\n  {products.length === 0 && !isLoading\r\n    ? <div className=\"text-center text-gray-500 text-sm py-8\">No products found</div>\r\n    : <div className=\"space-y-3\">\r\n        {products\r\n          .slice() // create a copy to avoid mutating original array\r\n          .sort((a, b) => b.stock_quantity - a.stock_quantity) // stock first, then low/out\r\n          .map(p => (\r\n            <ProductRow\r\n              key={p.id}\r\n              product={p}\r\n              onAdd={handleAddToCart}\r\n              disabled={getStockFor(p.id) === 0}\r\n            />\r\n          ))\r\n        }\r\n      </div>\r\n  }\r\n  {isLoading && <div className=\"text-center text-gray-400 py-3\">Loading more...</div>}\r\n  <div ref={loaderRef} className=\"h-20\"></div>\r\n</div>\r\n\r\n      </div>\r\n\r\n      {/* Cart Summary */}\r\n      <div className=\"w-full md:w-1/3 bg-white border border-gray-200 flex flex-col overflow-hidden\">\r\n        <div className=\"p-4 border-b border-gray-200 flex justify-between items-center\">\r\n          <h3 className=\"font-semibold text-gray-800\">Transaction summary</h3>\r\n          {cartItems.length > 0 && (\r\n            <button \r\n              onClick={() => setShowClearCartConfirm(true)}\r\n              className=\"text-xs font-medium hover:text-gray-700 transition border-2 border-gray-200 p-1 px-2 rounded-md bg-gray-100\"\r\n            >\r\n              Clear all\r\n            </button>\r\n          )}\r\n        </div>\r\n        <div className=\"flex-1 overflow-y-auto p-4\">\r\n          {cartItems.length === 0\r\n            ? <div className=\"text-center text-sm text-gray-500 py-8\">No items selected</div>\r\n            : <div className=\"space-y-4\">\r\n                {cartItems.map(it =>\r\n                  <CartItem \r\n                    key={it.id} \r\n                    item={it} \r\n                    product={it.product} \r\n                    stock={getStockFor(it.id)} \r\n                    onUpdateQuantity={updateCartItem} \r\n                    onLimit={() => setMessage({ type: \"info\", text: \"Stock limit reached\" })} \r\n                  />\r\n                )}\r\n              </div>\r\n          }\r\n        </div>\r\n        <div className=\"border-t border-gray-200 p-4\">\r\n          <div className=\"flex justify-between items-center mb-3\">\r\n            <span className=\"text-sm font-medium\">Total</span>\r\n            <span className=\"text-sm font-semibold\">{formatPeso(total)}</span>\r\n          </div>\r\n          <button\r\n            onClick={handleCompletePurchase}\r\n            disabled={cartItems.length === 0 || isProcessing}\r\n            className={`w-full py-2 rounded-md text-white text-sm font-medium transition-colors ${\r\n              cartItems.length === 0 || isProcessing ? \"bg-gray-300 cursor-not-allowed\" : \"bg-pink-500 hover:bg-pink-600\"\r\n            }`}\r\n          >\r\n            {cartItems.length === 0 ? \"Empty Cart\" : isProcessing ? \"Processing...\" : \"Confirm purchase\"}\r\n          </button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Toast & Modals */}\r\n      <MessageToast message={message} onClose={() => setMessage(null)} duration={1500} />\r\n      \r\n      {/* Modal & Dialogue */}\r\n      {showConfirm && (\r\n        <ConfirmModal \r\n          cartItems={cartItems} \r\n          onClose={() => setShowConfirm(false)} \r\n          onConfirm={confirmTransaction} \r\n        />\r\n      )}\r\n      \r\n      {showClearCartConfirm && (\r\n        <ClearCartDialogue\r\n          message=\"Clear Cart?\"\r\n          subMessage=\"Are you sure you want to remove all items from your cart? This action cannot be undone.\"\r\n          onConfirm={() => { \r\n            setCartItems([]); \r\n            setShowClearCartConfirm(false); \r\n            setMessage({ type: \"info\", text: \"Cart cleared\" }); \r\n          }}\r\n          onCancel={() => setShowClearCartConfirm(false)}\r\n        />\r\n      )}\r\n      \r\n      {showLeaveCartDialog && (\r\n        <LeaveCartItemDialog\r\n          message=\"Leave this Page?\"\r\n          subMessage=\"You have an ongoing transaction. Leaving now will discard all unsaved items.\"\r\n          onConfirm={() => { \r\n            setCartItems([]); \r\n            setShowLeaveCartDialog(false); \r\n            if (pendingNavigation) { \r\n              navigate(pendingNavigation); \r\n              setPendingNavigation(null); \r\n            }\r\n          }}\r\n          onCancel={() => setShowLeaveCartDialog(false)}\r\n        />\r\n      )}\r\n    </div>\r\n\r\n  );\r\n}"],"names":["createTransaction","payload","now","timezone","payloadWithTimestamp","api","error","useSellHandler","navigate","useNavigate","products","setProducts","useState","cartItems","setCartItems","selectedCategory","setSelectedCategory","searchInput","setSearchInput","page","setPage","hasMore","setHasMore","isLoading","setIsLoading","message","setMessage","showConfirm","setShowConfirm","isProcessing","setIsProcessing","showClearCartConfirm","setShowClearCartConfirm","showLeaveCartDialog","setShowLeaveCartDialog","pendingNavigation","setPendingNavigation","loaderRef","useRef","debouncedSearch","useDebounce","fetchProducts","useCallback","pageToFetch","res","getSellProductsData","data","prev","useEffect","categories","useMemo","categorySet","product","cat","uniqueCategories","name","idx","useInfiniteScroll","productsMap","map","p","getStockFor","id","handleAddToCart","existing","it","stock","updateCartItem","quantity","total","sum","handleCompletePurchase","confirmTransaction","snapshot","totalAmount","purchased","err","errorMsg","handler","e","normalizeCategory","c","ProductRow","onAdd","style","lowStockThreshold","handleClick","img","jsxs","jsx","formatPeso","ProductRow$1","React","CartItem","item","onUpdateQuantity","onLimit","price","subtotal","defaultImg","placeholderImg","inputQty","setInputQty","handleChange","val","newVal","handleBlur","qty","increment","decrement","CartItem$1","next","ConfirmModal","onConfirm","onClose","title","acc","ClearCartDialogue","onCancel","subMessage","LeaveCartItemDialog","SellsContent","a","b","MessageToast"],"mappings":"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"}