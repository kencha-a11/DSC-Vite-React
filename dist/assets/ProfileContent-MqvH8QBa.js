import{u as _,r as u,B as v,C as P,j as e}from"./index-QMmcz0e6.js";import{M as C}from"./MessageToast-CLlNtbAC.js";function S(){const{user:o,updateUserProfile:n}=_(),[l,d]=u.useState({first_name:"",last_name:"",email:"",phone_number:"",role:""}),[r,f]=u.useState({current_password:"",new_password:"",confirm_password:""}),[i,c]=u.useState(!1),[p,m]=u.useState(!1),[g,t]=u.useState(null),w=async()=>{try{const s=await v();if(s?.status==="success"&&s?.data){const a={first_name:s.data.first_name||"",last_name:s.data.last_name||"",email:s.data.email||"",phone_number:s.data.phone_number||"",role:s.data.role||""};d(a),n(a)}}catch(s){console.error(s),t({type:"error",text:"Failed to load profile. Please try again."})}},y=s=>{const{name:a,value:x}=s.target;d(h=>({...h,[a]:x}))},b=s=>{const{name:a,value:x}=s.target;f(h=>({...h,[a]:x}))},j=async s=>{s.preventDefault(),c(!0);try{const a=await n(l);d(a),t({type:"success",text:"Profile updated successfully!"})}catch(a){t({type:"error",text:a.response?.data?.message||"Error updating profile. Please try again."})}finally{c(!1)}},N=async s=>{if(s.preventDefault(),m(!0),l.role!=="admin"){t({type:"error",text:"Only administrators are allowed to change passwords."}),m(!1);return}if(r.new_password!==r.confirm_password){t({type:"error",text:"New password and confirmation do not match."}),m(!1);return}try{const a=await P({current_password:r.current_password,new_password:r.new_password,confirm_password:r.confirm_password});if(a?.status==="success")t({type:"success",text:a.message||"Password changed successfully!"}),f({current_password:"",new_password:"",confirm_password:""});else throw new Error("Password change failed")}catch(a){t({type:"error",text:a.response?.data?.message||"Error changing password. Please try again."})}finally{m(!1)}};return u.useEffect(()=>{w()},[]),{profile:l,passwords:r,profileLoading:i,passwordLoading:p,message:g,setMessage:t,handleProfileChange:y,handlePasswordChange:b,handleProfileSubmit:j,handlePasswordSubmit:N}}function D(){const{profile:o,passwords:n,profileLoading:l,passwordLoading:d,message:r,setMessage:f,handleProfileChange:i,handlePasswordChange:c,handleProfileSubmit:p,handlePasswordSubmit:m}=S();return e.jsxs(e.Fragment,{children:[e.jsx(C,{message:r,onClose:()=>f(null)}),e.jsx("main",{className:"w-full min-h-[calc(100vh-64px)] p-4 bg-gray-50 overflow-y-auto",children:e.jsxs("div",{className:"mx-auto space-y-8",children:[e.jsxs("section",{className:"bg-white rounded-2xl border border-gray-200 px-8 py-4 shadow-sm",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Profile Information"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Update your account’s profile information."})]}),e.jsxs("form",{onSubmit:p,className:"space-y-5",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-5",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"First name"}),e.jsx("input",{name:"first_name",value:o.first_name,onChange:i,type:"text",placeholder:"John",required:!0,className:"mt-1 w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-fuchsia-500"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Last name"}),e.jsx("input",{name:"last_name",value:o.last_name,onChange:i,type:"text",placeholder:"Doe",required:!0,className:"mt-1 w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-fuchsia-500"})]})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Phone number"}),e.jsx("input",{name:"phone_number",value:o.phone_number,onChange:i,type:"tel",placeholder:"09453748272",className:"mt-1 w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:ring-2 focus:ring-fuchsia-500"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Email"}),e.jsx("input",{name:"email",value:o.email,onChange:i,type:"email",placeholder:"johndoe@gmail.com",required:!0,className:"mt-1 w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:ring-2 focus:ring-fuchsia-500"})]}),e.jsx("div",{className:"pt-4 flex justify-start",children:e.jsx("button",{type:"submit",disabled:l,className:"inline-flex justify-center rounded-md bg-fuchsia-700 px-6 py-2 text-sm font-medium text-white hover:bg-fuchsia-800 focus:ring-2 focus:ring-fuchsia-400 disabled:opacity-50",children:l?"Saving...":"Save"})})]})]}),o.role==="admin"&&e.jsxs("section",{className:"bg-white rounded-2xl border border-gray-200 px-8 py-4 shadow-sm",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Password"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Ensure your account is using a long, random password."})]}),e.jsxs("form",{onSubmit:m,className:"space-y-5",children:[e.jsx("input",{type:"password",name:"current_password",value:n.current_password,onChange:c,placeholder:"Current password",className:"w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:ring-2 focus:ring-fuchsia-500"}),e.jsx("input",{type:"password",name:"new_password",value:n.new_password,onChange:c,placeholder:"New password",className:"w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:ring-2 focus:ring-fuchsia-500"}),e.jsx("input",{type:"password",name:"confirm_password",value:n.confirm_password,onChange:c,placeholder:"Confirm password",className:"w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:ring-2 focus:ring-fuchsia-500"}),e.jsx("div",{className:"pt-4 flex justify-start",children:e.jsx("button",{type:"submit",disabled:d,className:"inline-flex justify-center rounded-md bg-fuchsia-700 px-6 py-2 text-sm font-medium text-white hover:bg-fuchsia-800 focus:ring-2 focus:ring-fuchsia-400 disabled:opacity-50",children:d?"Saving...":"Save"})})]})]})]})}),e.jsx("footer",{className:"bg-gray-200 py-4 w-full",children:e.jsx("div",{className:"text-center text-sm text-gray-700",children:"© 2025 DSC Souvenirs. All rights reserved."})})]})}export{D as default};
//# sourceMappingURL=ProfileContent-MqvH8QBa.js.map
